!function(t){function i(t,i){return this.userOptions=h(t),this.name=t.name||t,this.parent=i,this}function e(t){for(var i=t.length,e=0;i--;)e+=t[i];return e}function s(t,i,e,a,o){var n,h=t.length;for(o||(o=0),e.depth||(e.depth=0);h--;)n=t[h],a&&(n.parent=a),n.categories?s(n.categories,i,e,n,o+1):r(i,n,a);e.depth=d(e.depth,o)}function r(t,e,s){for(t.unshift(new i(e,s));s;)s.leaves++||(s.leaves=1),s=s.parent}function a(t,i,e){i[0]===i[2]&&(i[0]=i[2]=c(i[0])-e%2/2),i[1]===i[3]&&(i[1]=i[3]=c(i[1])+e%2/2),t.push("M",i[0],i[1],"L",i[2],i[3])}function o(t,i){return t.getPosition(t.axis.horiz,i,t.axis.tickmarkOffset)}function n(t,i,e){for(var s,r=t.length;r--;)s=t[r][i],s&&n(s,i,e),e(t[r])}function h(t){return JSON.parse(JSON.stringify(t))}var l=void 0,c=Math.round,p=Math.min,d=Math.max,u=t.merge,g=t.pick,f=window.HighchartsAdapter&&window.HighchartsAdapter.inArray||t.inArray,x=t.Axis.prototype,b=t.Tick.prototype,y=x.init,v=x.render,k=x.setCategories,G=b.getLabelSize,z=b.addLabel,L=b.destroy,S=b.render;i.prototype.toString=function(){for(var t=[],i=this;i;)t.push(i.name),i=i.parent;return t.join(", ")},x.init=function(t,i){y.call(this,t,i),"object"==typeof i&&i.categories&&this.setupGroups(i)},x.setupGroups=function(t){var i,e=[],r={};i=h(t.categories),s(i,e,r),this.categoriesTree=i,this.categories=e,this.isGrouped=0!==r.depth,this.labelsDepth=r.depth,this.labelsSizes=[],this.labelsGridPath=[],this.tickLength=t.tickLength||this.tickLength||null,this.tickWidth=g(t.tickWidth,this.isXAxis?1:0),this.directionFactor=[-1,1,1,-1][this.side],this.options.lineWidth=g(t.lineWidth,1)},x.render=function(){if(this.isGrouped&&(this.labelsGridPath=[]),this.originalTickLength===l&&(this.originalTickLength=this.options.tickLength),this.options.tickLength=this.isGrouped?.001:this.originalTickLength,v.call(this),!this.isGrouped)return void(this.labelsGrid&&this.labelsGrid.attr({visibility:"hidden"}));var t,i=this,e=i.options,s=i.top,r=i.left,o=r+i.width,h=s+i.height,c=i.hasVisibleSeries||i.hasData,p=i.labelsDepth,d=i.labelsGrid,u=i.horiz,g=i.labelsGridPath,f=e.drawHorizontalBorders===!1?p+1:0,x=i.opposite?u?s:o:u?h:r,b=i.tickWidth;for(i.userTickLength&&(p-=1),d||(d=i.labelsGrid=i.chart.renderer.path().attr({strokeWidth:b,"stroke-width":b,stroke:e.tickColor}).add(i.axisGroup));p>=f;)x+=i.groupSize(f),t=u?[r,x,o,x]:[x,s,x,h],a(g,t,b),f++;d.attr({d:g,visibility:c?"visible":"hidden"}),i.labelGroup.attr({visibility:c?"visible":"hidden"}),n(i.categoriesTree,"categories",function(t){var e=t.tick;e&&(e.startAt+e.leaves-1<i.min||e.startAt>i.max?(e.label.hide(),e.destroyed=0):e.label.attr({visibility:c?"visible":"hidden"}))})},x.setCategories=function(t,i){this.categories&&this.cleanGroups(),this.setupGroups({categories:t}),this.categories=this.userOptions.categories=t,k.call(this,this.categories,i)},x.cleanGroups=function(){var t,i=this.ticks;for(t in i)i[t].parent&&delete i[t].parent;n(this.categoriesTree,"categories",function(t){var i,e=t.tick;if(e){e.label.destroy();for(i in e)delete e[i];delete t.tick}}),this.labelsGrid=null},x.groupSize=function(t,i){var s=this.labelsSizes,r=this.directionFactor,a=this.options.labels.groupedOptions?this.options.labels.groupedOptions[t-1]:!1,o=0;return a&&(o=-1==r?a.x?a.x:0:a.y?a.y:0),i!==l&&(s[t]=d(s[t]||0,i+10+Math.abs(o))),t===!0?e(s)*r:s[t]?s[t]*r:0},b.addLabel=function(){var t;z.call(this),this.axis.categories&&(t=this.axis.categories[this.pos])&&(this.label&&this.label.attr("text",this.axis.labelFormatter.call({axis:this.axis,chart:this.axis.chart,isFirst:this.isFirst,isLast:this.isLast,value:t.name})),this.axis.isGrouped&&this.axis.options.labels.enabled&&this.addGroupedLabels(t))},b.addGroupedLabels=function(t){for(var i,e=this,s=this.axis,r=s.chart,a=s.options.labels,o=a.useHTML,n=a.style,h=a.groupedOptions,l={align:"center",rotation:a.rotation,x:0,y:0},c=s.horiz?"height":"width",p=0;e;){if(p>0&&!t.tick){this.value=t.name;var d=a.formatter?a.formatter.call(this,t):t.name,g=h&&h[p-1],f=g?u(l,h[p-1]):l,x=g&&h[p-1].style?u(n,h[p-1].style):n;delete f.style,i=r.renderer.text(d,0,0,o).attr(f).css(x).add(s.labelGroup),e.startAt=this.pos,e.childCount=t.categories.length,e.leaves=t.leaves,e.visible=this.childCount,e.label=i,e.labelOffsets={x:f.x,y:f.y},t.tick=e}s.groupSize(p,e.label.getBBox()[c]),t=t.parent,e=t?e.parent=t.tick||{}:null,p++}},b.render=function(t,i,e){function s(t,i,e){var s=0;return k?(s=f(i.name,i.parent.categories),s=0>s?0:s):s}S.call(this,t,i,e);var r=this.axis.categories[this.pos];if(this.axis.isGrouped&&r&&!(this.pos>this.axis.max)){var n,h,l,c,u,g,x=this,b=x,y=x.axis,v=x.pos,k=x.isFirst,G=y.max,z=y.min,L=y.horiz,m=(y.categories[v],y.labelsGridPath),A=y.groupSize(0),O=(y.tickLength||A,y.tickWidth),w=(y.directionFactor,o(x,v)),T=L?w.y:w.x,F=y.chart.renderer.fontMetrics(y.options.labels.style.fontSize).b,M=1,W=L&&w.x===y.pos+y.len||!L&&w.y===y.pos?-1:0;for(k&&(n=L?[y.left,w.y,y.left,w.y+y.groupSize(!0)]:y.isXAxis?[w.x,y.top,w.x+y.groupSize(!0),y.top]:[w.x,y.top+y.len,w.x+y.groupSize(!0),y.top+y.len],a(m,n,O)),L&&y.left<w.x?a(m,[w.x-W,w.y,w.x-W,w.y+A],O):!L&&y.top<=w.y&&a(m,[w.x,w.y+W,w.x+A,w.y+W],O),A=T+A;b=b.parent;){var N=s(b,r,x),B=b.labelOffsets.x,C=b.labelOffsets.y;l=o(x,d(b.startAt-1,z-1)),c=o(x,p(b.startAt+b.leaves-1-N,G)),g=b.label.getBBox(!0),h=y.groupSize(M),W=L&&c.x===y.pos+y.len||!L&&c.y===y.pos?-1:0,u=L?{x:(l.x+c.x)/2+B,y:A+h/2+F-g.height/2-4+C/2}:{x:A+h/2+B,y:(l.y+c.y-g.height)/2+F+C},isNaN(u.x)||isNaN(u.y)||(b.label.attr(u),m&&(L&&y.left<c.x?a(m,[c.x-W,A,c.x-W,A+h],O):!L&&y.top<=c.y&&a(m,[A,c.y+W,A+h,c.y+W],O))),A+=h,M++}}},b.destroy=function(){for(var t=this;t=t.parent;)t.destroyed++||(t.destroyed=1);L.call(this)},b.getLabelSize=function(){if(this.axis.isGrouped===!0){var t=G.call(this)+10,i=this.axis.labelsSizes[0];return t>i&&(this.axis.labelsSizes[0]=t),e(this.axis.labelsSizes)}return G.call(this)}}(Highcharts);