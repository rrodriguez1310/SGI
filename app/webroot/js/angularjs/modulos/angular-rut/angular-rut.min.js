!function(e,t){"use strict";function r(e){return"string"==typeof e?e.replace(/[^0-9kK]+/g,"").toUpperCase():""}function n(e,t){if(e=r(e),!e)return t;if(e.length<=1)return e;for(var n=e.slice(-4,-1)+"-"+e.substr(e.length-1),u=4;u<e.length;u+=3)n=e.slice(-3-u,-u)+"."+n;return n}function u(e){if("string"!=typeof e)return!1;for(var t=parseInt(e.slice(0,-1),10),r=0,n=1;t>0;)n=(n+t%10*(9-r++%6))%11,t=Math.floor(t/10);var u=n>0?n-1+"":"K";return u===e.slice(-1)}function i(e,t){var i=function(r){var n="false"===t.rutDisabled?u(r):!0;return e.$setValidity("rut",n),n},a=function(e){return e=r(e),i(e)?e:null},l=function(e){if("true"===t.rutDisabled)var u=e;return e=r(e),i(e),"false"===t.rutDisabled?n(e):u};e.$parsers.unshift(a),e.$formatters.unshift(l)}function a(e,t,r){e.$watch(function(){return t.$viewValue},function(){t.$setViewValue("false"===r.rutDisabled?n(t.$viewValue):t.$viewValue),t.$render()})}function l(e,t,r){e.on("blur",function(){t.$setViewValue("false"===r.rutDisabled?n(t.$viewValue):t.$viewValue),t.$render()})}e.module("platanus.rut",[]).directive("ngRut",function(){return{restrict:"A",require:"ngModel",link:function(e,t,r,n){switch("undefined"==typeof r.rutDisabled&&(r.rutDisabled="false"),"undefined"==typeof r.rutFormat&&(r.rutFormat="live"),i(n,r),r.rutFormat){case"live":a(e,n,r);break;case"blur":l(t,n,r)}}}}).filter("rut",function(){return n}).constant("RutHelper",{format:n,clean:r,validate:function(e){return u(r(e))}})}(angular);